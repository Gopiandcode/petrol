<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Petrol (petrol.Petrol)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">petrol</a> &#x00BB; Petrol</nav><header class="odoc-preamble"><h1>Module <code><span>Petrol</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-table_name"><a href="#type-table_name" class="anchor"></a><code><span><span class="keyword">type</span> table_name</span></code></div><div class="spec-doc"><p>Uniquely identifies a table in the system.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Expr"><a href="#module-Expr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Expr/index.html">Expr</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Defines an extensible embedding of SQL expressions.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Type"><a href="#module-Type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Type/index.html">Type</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-query"><a href="#type-query" class="anchor"></a><code><span><span class="keyword">type</span> <span>('ret_ty, 'query_kind) query</span></span></code></div><div class="spec-doc"><p><code>('ret_ty, 'query_tag) query</code> represents an SQL query that returns values of type <code>'ret_ty</code> and is a SQL query of kind <code>'query_kind</code> -- see <a href="Query/index.html#type-t"><code>Petrol.Query.t</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-request"><a href="#type-request" class="anchor"></a><code><span><span class="keyword">type</span> <span>('res, 'multiplicity) request</span></span></code></div><div class="spec-doc"><p>Represents a compiled SQL database request.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Sqlite3"><a href="#module-Sqlite3" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Sqlite3/index.html">Sqlite3</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Defines <a href="#"><code>Petrol</code></a>'s e-DSL for Sqlite3 SQL.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Postgres"><a href="#module-Postgres" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Postgres/index.html">Postgres</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Defines <a href="#"><code>Petrol</code></a>'s e-DSL for Postgres SQL.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Schema"><a href="#module-Schema" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Schema/index.html">Schema</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Provides an E-DSL for specifying SQL tables in OCaml.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Query"><a href="#module-Query" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Query/index.html">Query</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Provides an E-DSL for specifying SQL queries in OCaml.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-StaticSchema"><a href="#module-StaticSchema" class="anchor"></a><code><span><span class="keyword">module</span> <a href="StaticSchema/index.html">StaticSchema</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Provides a helper interface, primarily for prototyping/debugging, that declares a static table without any versioning.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-VersionedSchema"><a href="#module-VersionedSchema" class="anchor"></a><code><span><span class="keyword">module</span> <a href="VersionedSchema/index.html">VersionedSchema</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Provides an interface that declares a versioned schema.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-exec"><a href="#val-exec" class="anchor"></a><code><span><span class="keyword">val</span> exec : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Caqti_lwt</span>.CONNECTION)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[&lt; `Zero ]</span>)</span> <a href="#type-request">request</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[&gt; <span class="xref-unresolved">Caqti_error</span>.call_or_retrieve ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>exec db req</code> executes a unit SQL request <code>req</code> on the SQL database <code>db</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find"><a href="#val-find" class="anchor"></a><code><span><span class="keyword">val</span> find : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Caqti_lwt</span>.CONNECTION)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span>[&lt; `One ]</span>)</span> <a href="#type-request">request</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span>[&gt; <span class="xref-unresolved">Caqti_error</span>.call_or_retrieve ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>find db req</code> executes a singleton SQL request <code>req</code> on the SQL database <code>db</code> returning the result.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_opt"><a href="#val-find_opt" class="anchor"></a><code><span><span class="keyword">val</span> find_opt : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Caqti_lwt</span>.CONNECTION)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span>[&lt; `One <span>| `Zero</span> ]</span>)</span> <a href="#type-request">request</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span><span class="type-var">'a</span> option</span>, <span>[&gt; <span class="xref-unresolved">Caqti_error</span>.call_or_retrieve ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>find_opt db req</code> executes a zero-or-one SQL request <code>req</code> on the SQL database <code>db</code> returning the result if it exists.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-collect_list"><a href="#val-collect_list" class="anchor"></a><code><span><span class="keyword">val</span> collect_list : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Caqti_lwt</span>.CONNECTION)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span>[&lt; `Many <span>| `One</span> <span>| `Zero</span> ]</span>)</span> <a href="#type-request">request</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span><span class="type-var">'a</span> list</span>, <span>[&gt; <span class="xref-unresolved">Caqti_error</span>.call_or_retrieve ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>collect_list db req</code> executes a SQL request <code>req</code> on the SQL database <code>db</code> and collects the results into a list.</p></div></div></div></body></html>