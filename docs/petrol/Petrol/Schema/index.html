<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Schema (petrol.Petrol.Schema)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">petrol</a> &#x00BB; <a href="../index.html">Petrol</a> &#x00BB; Schema</nav><header class="odoc-preamble"><h1>Module <code><span>Petrol.Schema</span></code></h1><p>Provides an E-DSL for specifying SQL tables in OCaml.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-conflict_clause"><a href="#type-conflict_clause" class="anchor"></a><code><span><span class="keyword">type</span> conflict_clause</span><span> = </span><span>[ </span></code><ol><li id="type-conflict_clause.ABORT" class="def constructor anchored"><a href="#type-conflict_clause.ABORT" class="anchor"></a><code><span>| </span></code><code><span>`ABORT</span></code></li><li id="type-conflict_clause.FAIL" class="def constructor anchored"><a href="#type-conflict_clause.FAIL" class="anchor"></a><code><span>| </span></code><code><span>`FAIL</span></code></li><li id="type-conflict_clause.IGNORE" class="def constructor anchored"><a href="#type-conflict_clause.IGNORE" class="anchor"></a><code><span>| </span></code><code><span>`IGNORE</span></code></li><li id="type-conflict_clause.REPLACE" class="def constructor anchored"><a href="#type-conflict_clause.REPLACE" class="anchor"></a><code><span>| </span></code><code><span>`REPLACE</span></code></li><li id="type-conflict_clause.ROLLBACK" class="def constructor anchored"><a href="#type-conflict_clause.ROLLBACK" class="anchor"></a><code><span>| </span></code><code><span>`ROLLBACK</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-foreign_conflict_clause"><a href="#type-foreign_conflict_clause" class="anchor"></a><code><span><span class="keyword">type</span> foreign_conflict_clause</span><span> = </span><span>[ </span></code><ol><li id="type-foreign_conflict_clause.CASCADE" class="def constructor anchored"><a href="#type-foreign_conflict_clause.CASCADE" class="anchor"></a><code><span>| </span></code><code><span>`CASCADE</span></code></li><li id="type-foreign_conflict_clause.NO_ACTION" class="def constructor anchored"><a href="#type-foreign_conflict_clause.NO_ACTION" class="anchor"></a><code><span>| </span></code><code><span>`NO_ACTION</span></code></li><li id="type-foreign_conflict_clause.RESTRICT" class="def constructor anchored"><a href="#type-foreign_conflict_clause.RESTRICT" class="anchor"></a><code><span>| </span></code><code><span>`RESTRICT</span></code></li><li id="type-foreign_conflict_clause.SET_DEFAULT" class="def constructor anchored"><a href="#type-foreign_conflict_clause.SET_DEFAULT" class="anchor"></a><code><span>| </span></code><code><span>`SET_DEFAULT</span></code></li><li id="type-foreign_conflict_clause.SET_NULL" class="def constructor anchored"><a href="#type-foreign_conflict_clause.SET_NULL" class="anchor"></a><code><span>| </span></code><code><span>`SET_NULL</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-constraint_"><a href="#type-constraint_" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a constraint_</span></span></code></div><div class="spec-doc"><p><code>'a constraint_</code> represents a constraint on an SQL column or columns.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-field"><a href="#type-field" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a field</span></span></code></div><div class="spec-doc"><p><code>'a field</code> represents an SQL table field definition.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-field"><a href="#val-field" class="anchor"></a><code><span><span class="keyword">val</span> field : 
  <span>?constraints:<span><span><span>[ `Column ]</span> <a href="#type-constraint_">constraint_</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>ty:<span><span class="type-var">'a</span> <a href="../Type/index.html#type-t">Type.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-field">field</a></span></span></code></div><div class="spec-doc"><p><code>field ?constraints name ~ty</code> constructs a new table column with name <code>name</code> and type <code>ty</code>.</p><p><code>constraints</code> are a list of column constraints for the column.</p><p><b>Note</b> <code>name</code> must be a valid SQL identifier - this is not checked by the function, but will cause an SQL error at runtime.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-table"><a href="#type-table" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a table</span></span><span> = </span></code><ol><li id="type-table.[]" class="def variant constructor anchored"><a href="#type-table.[]" class="anchor"></a><code><span>| </span><span><span class="constructor">[]</span> : <span>unit <a href="#type-table">table</a></span></span></code></li><li id="type-table.::" class="def variant constructor anchored"><a href="#type-table.::" class="anchor"></a><code><span>| </span><span><span class="constructor">::</span> : <span>(<span><span class="type-var">'a</span> <a href="#type-field">field</a></span> * <span><span class="type-var">'b</span> <a href="#type-table">table</a></span>)</span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-table">table</a></span></span></code></li></ol></div><div class="spec-doc"><p><code>'a table</code> represents a heterogeneous list of fields in a SQL Table schema, where <code>'a</code> captures the types of each element.</p><p>Like <a href="../Expr/index.html#type-expr_list"><code>Expr.expr_list</code></a>, if you have opened the Schema module, you can use vanilla list syntax to construct terms of this type.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-primary_key"><a href="#val-primary_key" class="anchor"></a><code><span><span class="keyword">val</span> primary_key : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?ordering:<span>[ `ASC <span>| `DESC</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?on_conflict:<a href="#type-conflict_clause">conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?auto_increment:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Column ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>primary_key ?name ?ordering ?on_conflict ?auto_increment ()</code> returns a new SQL column constraint that indicates that the column it is attached to must be the primary key.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>ordering</code> is the ordering of the primary key index.</p><p><code>on_conflict</code> specifies how to handle conflicts.</p><p><code>auto_increment</code> specifies whether the primary key should be automatically generated.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-table_primary_key"><a href="#val-table_primary_key" class="anchor"></a><code><span><span class="keyword">val</span> table_primary_key : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?on_conflict:<a href="#type-conflict_clause">conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Table ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>table_primary_key ?name ?on_conflict cols</code> returns a new SQL table constraint that specifies that the table it is attached to's primary key is over the columns in <code>cols</code>.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>on_conflict</code> specifies how to handle conflicts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-not_null"><a href="#val-not_null" class="anchor"></a><code><span><span class="keyword">val</span> not_null : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?on_conflict:<a href="#type-conflict_clause">conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Column ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>not_null ?name ?on_conflict ()</code> returns a new SQL column constraint that specifies that the column it is attached to's value must not be NULL.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>on_conflict</code> specifies how to handle conflicts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unique"><a href="#val-unique" class="anchor"></a><code><span><span class="keyword">val</span> unique : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?on_conflict:<a href="#type-conflict_clause">conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Column ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>unique ?name ?on_conflict ()</code> returns a new SQL column constraint that specifies that the column it is attached to's values must be unique.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>on_conflict</code> specifies how to handle conflicts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-table_unique"><a href="#val-table_unique" class="anchor"></a><code><span><span class="keyword">val</span> table_unique : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?on_conflict:<a href="#type-conflict_clause">conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Table ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>unique ?name ?on_conflict cols</code> returns a new SQL table constraint that specifies that the table it is attached to's values for the columns <code>cols</code> must be unique.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>on_conflict</code> specifies how to handle conflicts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-foreign_key"><a href="#val-foreign_key" class="anchor"></a><code><span><span class="keyword">val</span> foreign_key : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?on_update:<a href="#type-foreign_conflict_clause">foreign_conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?on_delete:<a href="#type-foreign_conflict_clause">foreign_conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>table:<a href="../index.html#type-table_name">table_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span>columns:<span><span class="type-var">'a</span> <a href="../Expr/index.html#type-expr_list">Expr.expr_list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Column ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>foreign_key ?name ?on_update ?on_delete ~table ~columns ()</code> returns a new SQL column constraint that specifies that the column it is attached to's values must be a foreign key into the table <code>table</code> with columns <code>columns</code>.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>on_update</code> and <code>on_delete</code> specifies how to handle conflicts for updates and deletes respectively.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-table_foreign_key"><a href="#val-table_foreign_key" class="anchor"></a><code><span><span class="keyword">val</span> table_foreign_key : 
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span>?on_update:<a href="#type-foreign_conflict_clause">foreign_conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?on_delete:<a href="#type-foreign_conflict_clause">foreign_conflict_clause</a> <span class="arrow">&#45;&gt;</span></span>
  <span>table:<a href="../index.html#type-table_name">table_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span>columns:<span><span class="type-var">'a</span> <a href="../Expr/index.html#type-expr_list">Expr.expr_list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Table ]</span> <a href="#type-constraint_">constraint_</a></span></span></code></div><div class="spec-doc"><p><code>table_foreign_key ?name ?on_update ?on_delete ~table ~columns
        cols</code> returns a new SQL table constraint that specifies that the table it is attached to's values for the columns <code>cols</code> must be a foreign key into the table <code>table</code> with columns <code>columns</code>.</p><p><code>name</code> is an optional name for the constraint for debugging purposes.</p><p><code>on_update</code> and <code>on_delete</code> specifies how to handle conflicts for updates and deletes respectively..</p></div></div></div></body></html>